generator client {
    binaryTargets   = "native"
    previewFeatures = ["jsonProtocol"]
    provider        = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

enum Role {
    OWNER
    ADMIN
    USER
}

model User {
    id          String       @id @default(uuid())
    role        Role         @default(USER)
    username    String       @unique
    credentials Credential[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Credential {
    id         Int      @id @default(autoincrement())
    userId     String
    name       String?
    externalId String   @unique
    publicKey  Bytes    @unique
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    user User @relation(fields: [userId], references: [id])

    @@index([externalId])
}
